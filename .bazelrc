# Bazel settings that apply to this repository.
# Take care to document any settings that you expect users to apply.
# Settings that apply only to CI are in .github/workflows/ci.bazelrc

# Required by rules_js
build --enable_runfiles

build --incompatible_strict_action_env
build --nolegacy_external_runfiles

# //example/custom_sequencer:case2_test target sets `auto_configure_test_sequencer = False` which
# causes the following error on Bazel 7 unless --noincompatible_check_sharding_support is
# ERROR: Testing //example/custom_sequencer:case2_test (shard 2 of 2) failed: Sharding requested,
# but the test runner did not advertise support for it by touching TEST_SHARD_STATUS_FILE. Either
# remove the 'shard_count' attribute, use a test runner that supports sharding or temporarily disable
# this check via --noincompatible_check_sharding_support.
test --noincompatible_check_sharding_support

# Output test errors to stderr so users don't have to `cat` or open test failure log files when test
# fail. This makes the log noiser in exchange for reducing the time-to-feedback on test failures for
# users.
# Docs: https://bazel.build/docs/user-manual#test-output
test --test_output=errors

# Load any settings specific to the current user.
# .bazelrc.user should appear in .gitignore so that settings are not shared with team members
# This needs to be last statement in this
# config, as the user configuration should be able to overwrite flags from this file.
# See https://docs.bazel.build/versions/master/best-practices.html#bazelrc
# (Note that we use .bazelrc.user so the file appears next to .bazelrc in directory listing,
# rather than user.bazelrc as suggested in the Bazel docs)
try-import %workspace%/.bazelrc.user
